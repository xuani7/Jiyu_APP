(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-community-community"],{8145:function(t,e,a){"use strict";a.r(e);var n=a("8f7a"),i=a.n(n);for(var l in n)["default"].indexOf(l)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(l);e["default"]=i.a},"8f7a":function(t,e,a){"use strict";(function(t){a("7a82");var n=a("dbce").default,i=a("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("b64b"),a("14d9");var l=i(a("2909")),c=i(a("c7eb")),r=i(a("1da1")),u=i(a("4b15")),s=i(a("7f22")),o=i(a("5a4e")),d=i(a("23f7")),f=(a("080b"),n(a("fe86"))),h={components:{navBar:u.default,Dynamic:s.default,loadMore:o.default,backTop:d.default},data:function(){return{backTop:{src:"../../static/back-top/top.png",scrollTop:0},scrollTop:0,title:"社区",startX:0,list:[],status:"loading",page:1,flag:!1}},onPageScroll:function(t){this.backTop.scrollTop=t.scrollTop},onReachBottom:function(){var t=this;this.status="loading",setTimeout((function(){t.page=++t.page,t.getArticles(0,t.page),t.flag?(t.status="down",t.flag=!1):t.status="normal"}),1e3)},onUnload:function(){this.list=[]},methods:{clickThumbsup:function(e){var a=this;return(0,r.default)((0,c.default)().mark((function n(){var i;return(0,c.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.getClickArticle(e);case 2:i=n.sent,i.result.data[0]._id.user_article[0].isLike?(i.result.data[0]._id.user_article[0].isLike=!1,i.result.data[0].likeNumber-=1):(i.result.data[0]._id.user_article[0].isLike=!0,i.result.data[0].likeNumber+=1),t.callFunction({name:"setArticleById",data:i.result.data[0]}).then((function(t){console.log(t)}));case 5:case"end":return n.stop()}}),n)})))()},clickCollect:function(e){var a=this;return(0,r.default)((0,c.default)().mark((function n(){var i;return(0,c.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.getClickArticle(e);case 2:i=n.sent,i.result.data[0]._id.user_article[0].isCollect?(i.result.data[0]._id.user_article[0].isCollect=!1,i.result.data[0].collectNumber-=1):(i.result.data[0]._id.user_article[0].isCollect=!0,i.result.data[0].collectNumber+=1),t.callFunction({name:"setArticleById",data:i.result.data[0]}).then((function(t){console.log(t)}));case 5:case"end":return n.stop()}}),n)})))()},clickShare:function(t){var e=this;return(0,r.default)((0,c.default)().mark((function a(){var n,i,l;return(0,c.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n={shareUrl:"https://bilibili.com/",shareTitle:"快看我发现了什么宝藏~",shareContent:"",shareImg:"http://qn.kemean.cn//upload/202004/18/1587189024467w6xj18b1.jpg",appId:"wxd0e0881530ee4444",appPath:"pages/home/home",appWebUrl:"https://bilibili.com/"},a.next=3,e.getClickArticle(t);case 3:i=a.sent,console.log(i),n.shareContent=i.result.data[0].content,n.shareImg=i.result.data[0].imgList[0],l=(0,f.default)(n,(function(t){console.log("分享成功回调",t),(0,f.closeShare)()})),setTimeout((function(){l.close()}),5e3);case 9:case"end":return a.stop()}}),a)})))()},getClickArticle:function(e){return t.callFunction({name:"getArticleById",data:{id:e}})},getArticles:function(e,a){var n=this;t.callFunction({name:"getArticles",data:{page:a}}).then((function(t){var e;0!==Object.keys(t.result.data).length?((e=n.list).push.apply(e,(0,l.default)(t.result.data)),n.flag=!0):Object.keys(t.result.data).length<5&&Object.keys(t.result.data).length>0?(n.flag=!1,n.status="normal"):(n.page-=1,n.flag=!1)})),1===e&&uni.stopPullDownRefresh()},touchStart:function(t){1==t.touches.length&&(this.startX=t.touches[0].clientX)},touchEnd:function(t){if(1==t.changedTouches.length){var e=t.changedTouches[0].clientX,a=e-this.startX;Math.abs(a)}}},onLoad:function(){var t=this;this.$nextTick((function(){t.getArticles(0,t.page)}))},onPullDownRefresh:function(){var t=this;this.$nextTick((function(){t.list=[],t.page=1,t.getArticles(1,t.page)}))}};e.default=h}).call(this,a("a9ff")["default"])},"95d5":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return l})),a.d(e,"a",(function(){return n}));var n={loadMore:a("5a4e").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"container",on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.touchStart.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.touchEnd.apply(void 0,arguments)}}},[a("navBar",{attrs:{title:t.title}}),t._l(t.list,(function(e,n){return a("Dynamic",{key:e._id._value,attrs:{imgList:e.imgList,avatar:e.user_id[0].avatarUrl,name:e.user_id[0].nickname?e.user_id[0].nickname:e.user_id[0].username,publishTime:e.publishTime,content:e.content,isLike:!!e._id.user_article[0].isLike&&e._id.user_article[0].isLike,isCollect:!!e._id.user_article[0].isCollect&&e._id.user_article[0].isCollect,likeNumber:e.likeNumber,collectNumber:e.collectNumber},on:{clickDynamic:function(e){arguments[0]=e=t.$handleEvent(e),t.clickDynamic(n)},clickThumbsup:function(a){arguments[0]=a=t.$handleEvent(a),t.clickThumbsup(e._id._value)},clickCollect:function(a){arguments[0]=a=t.$handleEvent(a),t.clickCollect(e._id._value)},clickShare:function(a){arguments[0]=a=t.$handleEvent(a),t.clickShare(e._id._value)}}})})),a("backTop",{attrs:{src:t.backTop.src,scrollTop:t.backTop.scrollTop}}),a("loadMore",{attrs:{mode:"loading1",color:"#686870",status:t.status,textSize:"12px",textColor:"#808080"}})],2)},l=[]},f95d:function(t,e,a){"use strict";a.r(e);var n=a("95d5"),i=a("8145");for(var l in i)["default"].indexOf(l)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(l);var c=a("f0c5"),r=Object(c["a"])(i["default"],n["b"],n["c"],!1,null,"7d52bb38",null,!1,n["a"],void 0);e["default"]=r.exports}}]);